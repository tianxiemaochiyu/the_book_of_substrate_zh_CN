<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Custom RPCs | Substrate Recipes</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="Substrate Recipes">
    <link rel="preload" href="/assets/css/0.styles.ad025e7c.css" as="style"><link rel="preload" href="/assets/js/app.a10ecbc3.js" as="script"><link rel="preload" href="/assets/js/3.911ff76f.js" as="script"><link rel="preload" href="/assets/js/1.8aeda072.js" as="script"><link rel="preload" href="/assets/js/32.ea727ff0.js" as="script"><link rel="prefetch" href="/assets/js/10.f6e4b8e2.js"><link rel="prefetch" href="/assets/js/100.7dc1ff05.js"><link rel="prefetch" href="/assets/js/101.297542a2.js"><link rel="prefetch" href="/assets/js/102.4a256fa2.js"><link rel="prefetch" href="/assets/js/103.0d6e0535.js"><link rel="prefetch" href="/assets/js/104.8cf46d1e.js"><link rel="prefetch" href="/assets/js/105.63908dc3.js"><link rel="prefetch" href="/assets/js/106.9bb37e6d.js"><link rel="prefetch" href="/assets/js/107.d8653b02.js"><link rel="prefetch" href="/assets/js/108.4d618824.js"><link rel="prefetch" href="/assets/js/109.904cfb03.js"><link rel="prefetch" href="/assets/js/11.81ae87e1.js"><link rel="prefetch" href="/assets/js/110.9246670b.js"><link rel="prefetch" href="/assets/js/111.2a53fdf3.js"><link rel="prefetch" href="/assets/js/112.2377b53a.js"><link rel="prefetch" href="/assets/js/113.c460dd88.js"><link rel="prefetch" href="/assets/js/114.b5d73637.js"><link rel="prefetch" href="/assets/js/115.362b464f.js"><link rel="prefetch" href="/assets/js/116.2f85b476.js"><link rel="prefetch" href="/assets/js/117.76166f7d.js"><link rel="prefetch" href="/assets/js/118.6e1563f6.js"><link rel="prefetch" href="/assets/js/119.57707c67.js"><link rel="prefetch" href="/assets/js/12.4527bb4d.js"><link rel="prefetch" href="/assets/js/120.2395aeb4.js"><link rel="prefetch" href="/assets/js/121.56c41d8d.js"><link rel="prefetch" href="/assets/js/122.fa2cde0f.js"><link rel="prefetch" href="/assets/js/123.7811c41b.js"><link rel="prefetch" href="/assets/js/124.c6bc1d12.js"><link rel="prefetch" href="/assets/js/125.cd517541.js"><link rel="prefetch" href="/assets/js/126.658b224e.js"><link rel="prefetch" href="/assets/js/127.08cca44a.js"><link rel="prefetch" href="/assets/js/128.df264345.js"><link rel="prefetch" href="/assets/js/129.5a1b8921.js"><link rel="prefetch" href="/assets/js/13.00771e07.js"><link rel="prefetch" href="/assets/js/130.3fc6ac18.js"><link rel="prefetch" href="/assets/js/131.6f4d6fd1.js"><link rel="prefetch" href="/assets/js/132.acdc1129.js"><link rel="prefetch" href="/assets/js/133.a3f54cd0.js"><link rel="prefetch" href="/assets/js/134.119c2728.js"><link rel="prefetch" href="/assets/js/135.9f6c57f3.js"><link rel="prefetch" href="/assets/js/136.ac7dd858.js"><link rel="prefetch" href="/assets/js/137.9afb710a.js"><link rel="prefetch" href="/assets/js/14.469caac5.js"><link rel="prefetch" href="/assets/js/15.9cb4518c.js"><link rel="prefetch" href="/assets/js/16.eb52a98b.js"><link rel="prefetch" href="/assets/js/17.fd207c74.js"><link rel="prefetch" href="/assets/js/18.9ac8edf4.js"><link rel="prefetch" href="/assets/js/19.7fd9cce0.js"><link rel="prefetch" href="/assets/js/20.3ac6699b.js"><link rel="prefetch" href="/assets/js/21.9bd21d49.js"><link rel="prefetch" href="/assets/js/22.26135513.js"><link rel="prefetch" href="/assets/js/23.12ca47ae.js"><link rel="prefetch" href="/assets/js/24.07c26276.js"><link rel="prefetch" href="/assets/js/25.1fb4186a.js"><link rel="prefetch" href="/assets/js/26.c0b427e0.js"><link rel="prefetch" href="/assets/js/27.a4c80d07.js"><link rel="prefetch" href="/assets/js/28.32d98e1e.js"><link rel="prefetch" href="/assets/js/29.3c8c6d0a.js"><link rel="prefetch" href="/assets/js/30.bedbe07f.js"><link rel="prefetch" href="/assets/js/31.01411239.js"><link rel="prefetch" href="/assets/js/33.87e3a077.js"><link rel="prefetch" href="/assets/js/34.76c8aca7.js"><link rel="prefetch" href="/assets/js/35.98662951.js"><link rel="prefetch" href="/assets/js/36.845ccc35.js"><link rel="prefetch" href="/assets/js/37.66285bdf.js"><link rel="prefetch" href="/assets/js/38.cd20e592.js"><link rel="prefetch" href="/assets/js/39.b1b64548.js"><link rel="prefetch" href="/assets/js/4.da5852d0.js"><link rel="prefetch" href="/assets/js/40.32bbdbca.js"><link rel="prefetch" href="/assets/js/41.0d53a13c.js"><link rel="prefetch" href="/assets/js/42.9d946ef7.js"><link rel="prefetch" href="/assets/js/43.611048bf.js"><link rel="prefetch" href="/assets/js/44.adc1e594.js"><link rel="prefetch" href="/assets/js/45.54a35f8b.js"><link rel="prefetch" href="/assets/js/46.df5202cc.js"><link rel="prefetch" href="/assets/js/47.ba4c91a1.js"><link rel="prefetch" href="/assets/js/48.ad895aa9.js"><link rel="prefetch" href="/assets/js/49.f968d914.js"><link rel="prefetch" href="/assets/js/5.a9148791.js"><link rel="prefetch" href="/assets/js/50.5a347983.js"><link rel="prefetch" href="/assets/js/51.dba56927.js"><link rel="prefetch" href="/assets/js/52.9f01b6c1.js"><link rel="prefetch" href="/assets/js/53.cfa95d58.js"><link rel="prefetch" href="/assets/js/54.4e7ad936.js"><link rel="prefetch" href="/assets/js/55.2f053dbe.js"><link rel="prefetch" href="/assets/js/56.f8e4f338.js"><link rel="prefetch" href="/assets/js/57.8c30d45b.js"><link rel="prefetch" href="/assets/js/58.4a810bd8.js"><link rel="prefetch" href="/assets/js/59.bde195e5.js"><link rel="prefetch" href="/assets/js/6.f03db119.js"><link rel="prefetch" href="/assets/js/60.e9be82f8.js"><link rel="prefetch" href="/assets/js/61.13406dc4.js"><link rel="prefetch" href="/assets/js/62.672f6c8a.js"><link rel="prefetch" href="/assets/js/63.5ded7553.js"><link rel="prefetch" href="/assets/js/64.6b7f090e.js"><link rel="prefetch" href="/assets/js/65.bcda81a0.js"><link rel="prefetch" href="/assets/js/66.0b93a1c7.js"><link rel="prefetch" href="/assets/js/67.c584467f.js"><link rel="prefetch" href="/assets/js/68.5d410b3b.js"><link rel="prefetch" href="/assets/js/69.e6964620.js"><link rel="prefetch" href="/assets/js/7.0285f972.js"><link rel="prefetch" href="/assets/js/70.2ac6e3e7.js"><link rel="prefetch" href="/assets/js/71.76290ed4.js"><link rel="prefetch" href="/assets/js/72.0338d739.js"><link rel="prefetch" href="/assets/js/73.10458f48.js"><link rel="prefetch" href="/assets/js/74.eb0146bd.js"><link rel="prefetch" href="/assets/js/75.f7e34977.js"><link rel="prefetch" href="/assets/js/76.321dfdeb.js"><link rel="prefetch" href="/assets/js/77.19009647.js"><link rel="prefetch" href="/assets/js/78.a244a0af.js"><link rel="prefetch" href="/assets/js/79.504de44a.js"><link rel="prefetch" href="/assets/js/8.16c0171d.js"><link rel="prefetch" href="/assets/js/80.bfaf64db.js"><link rel="prefetch" href="/assets/js/81.57121759.js"><link rel="prefetch" href="/assets/js/82.60fe79be.js"><link rel="prefetch" href="/assets/js/83.65bd8161.js"><link rel="prefetch" href="/assets/js/84.a80c2a84.js"><link rel="prefetch" href="/assets/js/85.7fd8dffd.js"><link rel="prefetch" href="/assets/js/86.7fdcf982.js"><link rel="prefetch" href="/assets/js/87.2e61ea62.js"><link rel="prefetch" href="/assets/js/88.96ae1006.js"><link rel="prefetch" href="/assets/js/89.6ea5f56c.js"><link rel="prefetch" href="/assets/js/9.3daa8733.js"><link rel="prefetch" href="/assets/js/90.ffb91ca4.js"><link rel="prefetch" href="/assets/js/91.650af2b8.js"><link rel="prefetch" href="/assets/js/92.4fb6096a.js"><link rel="prefetch" href="/assets/js/93.ebd206ec.js"><link rel="prefetch" href="/assets/js/94.136dbf66.js"><link rel="prefetch" href="/assets/js/95.b8f07d6b.js"><link rel="prefetch" href="/assets/js/96.be7d3c6e.js"><link rel="prefetch" href="/assets/js/97.b07f412c.js"><link rel="prefetch" href="/assets/js/98.341cdd7c.js"><link rel="prefetch" href="/assets/js/99.c619520d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ad025e7c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Substrate Recipes</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><!---->
            
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Substrate Recipes</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/3-entrees/custom-rpc.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/3-entrees/custom-rpc.html" class="nav-link"><i class="iconfont undefined"></i>
  简体中文
</a></li></ul></div></div> <a href="https://github.com/tianxiemaochiyu/the_book_of_substrate_zh_CN" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><!----> <!----> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>0</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>0</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/3-entrees/custom-rpc.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/3-entrees/custom-rpc.html" class="nav-link"><i class="iconfont undefined"></i>
  简体中文
</a></li></ul></div></div> <a href="https://github.com/tianxiemaochiyu/the_book_of_substrate_zh_CN" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/" class="sidebar-heading clickable router-link-active open"><span>Substrate</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Introduction.html" class="sidebar-link">Introduction</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/1-prepare-kitchen/index" class="sidebar-heading clickable"><span>1. Preparing Your Kitchen</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/1-prepare-kitchen/1-build-node.html" class="sidebar-link">1.1. Building A Node</a></li><li><a href="/1-prepare-kitchen/2-interact-node.html" class="sidebar-link">1.2. Interacting with a Node</a></li><li><a href="/1-prepare-kitchen/3-kitchen-organization.html" class="sidebar-link">1.3. Kitchen Organization</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/2-appetizers/index" class="sidebar-heading clickable"><span>2. Appetizers</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/2-appetizers/1-hello-substrate.html" class="sidebar-link">2.1. Hello Substrate</a></li><li><a href="/2-appetizers/2-storage-values.html" class="sidebar-link">2.2. Single Value Storage</a></li><li><a href="/2-appetizers/3-errors.html" class="sidebar-link">2.3. Handling Errors</a></li><li><a href="/2-appetizers/4-events.html" class="sidebar-link">2.4. Events Verify Execution</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/3-entrees/index" class="sidebar-heading clickable open"><span>3. Entrees</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-2"><a href="/3-entrees/storage-api/index" class="sidebar-heading clickable open"><span>3.1. Runtime Storage API</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/3-entrees/storage-api/storage-maps.html" class="sidebar-link">3.1.1. Runtime Storage API</a></li><li><a href="/3-entrees/storage-api/cache.html" class="sidebar-link">3.1.2. Cache Locally &gt; Storage Calls</a></li><li><a href="/3-entrees/storage-api/vec-set.html" class="sidebar-link">3.1.3. Using Vectors as Sets</a></li><li><a href="/3-entrees/storage-api/map-set.html" class="sidebar-link">3.1.4. Using Maps as Sets</a></li><li><a href="/3-entrees/storage-api/double.html" class="sidebar-link">3.1.5. Subgroup Removal by Subkey: Double Maps</a></li><li><a href="/3-entrees/storage-api/structs.html" class="sidebar-link">3.1.6. Storing custom structs</a></li><li><a href="/3-entrees/storage-api/ringbuffer.html" class="sidebar-link">3.1.7. Ringbuffer Queue</a></li></ul></section></li><li><a href="/3-entrees/basic-token.html" class="sidebar-link">3.2. Basic Token</a></li><li><a href="/3-entrees/constants.html" class="sidebar-link">3.3. Configurable Constants</a></li><li><a href="/3-entrees/crowdfund.html" class="sidebar-link">3.4. Simple Crowdfund</a></li><li><a href="/3-entrees/instantiable.html" class="sidebar-link">3.5. Instantiable Pallets</a></li><li><a href="/3-entrees/weights.html" class="sidebar-link">3.6. Weights for Resource Accounting</a></li><li><a href="/3-entrees/fees.html" class="sidebar-link">3.7. Transaction Fees for Economic Security</a></li><li><a href="/3-entrees/charity.html" class="sidebar-link">3.8. Charity and Imbalances</a></li><li><a href="/3-entrees/fixed-point.html" class="sidebar-link">3.9. Fixed Point Arithmetic</a></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/3-entrees/off-chain-workers/index" class="sidebar-heading clickable"><span>3.10. Off-chain Workers</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/3-entrees/off-chain-workers/transactions.html" class="sidebar-link">3.10.1. Transactions</a></li><li><a href="/3-entrees/off-chain-workers/http-json.html" class="sidebar-link">3.10.2. HTTP Fetching &amp; JSON Parsing</a></li><li><a href="/3-entrees/off-chain-workers/storage.html" class="sidebar-link">3.10.3. Local Storage</a></li></ul></section></li><li><a href="/3-entrees/runtime-api.html" class="sidebar-link">3.11. Runtime APIs</a></li><li><a href="/3-entrees/custom-rpc.html" aria-current="page" class="active sidebar-link">3.12. Custom RPCs</a></li><li><a href="/3-entrees/sha3-pow-consensus.html" class="sidebar-link">3.13. Sha3 Pow Consensus Algorithms</a></li><li><a href="/3-entrees/basic-pow.html" class="sidebar-link">3.14. Basic Proof of Work Node</a></li><li><a href="/3-entrees/hybrid-consensus.html" class="sidebar-link">3.15. Hybrid PoW/PoS Consensus Node</a></li><li><a href="/3-entrees/manual-seal.html" class="sidebar-link">3.16. Manual Seal Consensus</a></li><li><a href="/3-entrees/kitchen-node.html" class="sidebar-link">3.17. Kitchen Node - An reusable instant seal node</a></li><li><a href="/3-entrees/babe-grandpa-node.html" class="sidebar-link">3.18. Babe and Grandpa Node</a></li><li><a href="/3-entrees/currency.html" class="sidebar-link">3.19. Currency Types</a></li><li><a href="/3-entrees/randomness.html" class="sidebar-link">3.20. Generating Randomness</a></li><li><a href="/3-entrees/execution-schedule.html" class="sidebar-link">3.21. Execution Schedule</a></li><li><a href="/3-entrees/pallet-coupling.html" class="sidebar-link">3.22. Tightly- and Loosely-Coupled Pallets</a></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/3-entrees/testing/index" class="sidebar-heading clickable"><span>3.23. Testing</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/3-entrees/testing/mock.html" class="sidebar-link">3.23.1. Basic Test Environments</a></li><li><a href="/3-entrees/testing/common.html" class="sidebar-link">3.23.2. Common Testsg</a></li><li><a href="/3-entrees/testing/off-chain-workers.html" class="sidebar-link">3.23.3. Off-chain Worker Test Environment</a></li><li><a href="/3-entrees/testing/externalities.html" class="sidebar-link">3.23.4. Custom Test Environment</a></li></ul></section></li><li><a href="/3-entrees/safemath.html" class="sidebar-link">3.24. Safe Math</a></li></ul></section></li><li><a href="/more-resources.html" class="sidebar-link">4. More Resources</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><!---->
            
          <!---->
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>Custom RPCs</h1> <div data-v-3b7f5bdf><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="custom-rpcs"><a href="#custom-rpcs" class="header-anchor">#</a> Custom RPCs</h1> <p><code>nodes/custom-rpc</code> <a href="https://playground-staging.substrate.dev/?deploy=recipes&amp;files=%2Fhome%2Fsubstrate%2Fworkspace%2Fnodes%2Fcustom-rpc%2Fsrc%2Flib.rs" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Playground-Try%20it!-brightgreen?logo=Parity%20Substrate" alt="Try on playground"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/substrate-developer-hub/recipes/tree/master/nodes/custom-rpc/src/lib.rs" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Github-View%20Code-brightgreen?logo=github" alt="View on GitHub"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>runtimes/api-runtime</code> <a href="https://playground-staging.substrate.dev/?deploy=recipes&amp;files=%2Fhome%2Fsubstrate%2Fworkspace%2Fruntimes%2Fapi-runtime%2Fsrc%2Flib.rs" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Playground-Try%20it!-brightgreen?logo=Parity%20Substrate" alt="Try on playground"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/substrate-developer-hub/recipes/tree/master/runtimes/api-runtime/src/lib.rs" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Github-View%20Code-brightgreen?logo=github" alt="View on GitHub"> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Remote Procedure Calls, or RPCs, are a way for an external program (eg. a frontend) to communicate
with a Substrate node. They are used for checking storage values, submitting transactions, and
querying the current consensus authorities. Substrate comes with several
<a href="https://polkadot.js.org/api/substrate/rpc.html" target="_blank" rel="noopener noreferrer">default RPCs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. In many cases it is useful to add
custom RPCs to your node. In this recipe, we will add two custom RPCs to our node, one of which
calls into a <a href="/3-entrees/runtime-api.html">custom runtime API</a>.</p> <h2 id="defining-an-rpc"><a href="#defining-an-rpc" class="header-anchor">#</a> Defining an RPC</h2> <p>Every RPC that the node will use must be defined in a trait. We'll begin by defining a simple RPC
called &quot;silly rpc&quot; which just returns constant integers. A Hello world of sorts. In the
<code>nodes/rpc-node/src/silly_rpc.rs</code> file, we define a basic rpc as</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[rpc]</span>
<span class="token keyword">pub</span> <span class="token keyword">trait</span> <span class="token class-name">SillyRpc</span> <span class="token punctuation">{</span>
	<span class="token attribute attr-name">#[rpc(name = <span class="token string">&quot;silly_seven&quot;</span>)]</span>
	<span class="token keyword">fn</span> <span class="token function-definition function">silly_7</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

	<span class="token attribute attr-name">#[rpc(name = <span class="token string">&quot;silly_double&quot;</span>)]</span>
	<span class="token keyword">fn</span> <span class="token function-definition function">silly_double</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> val<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This definition defines two RPC methods called <code>hello_five</code> and <code>hello_seven</code>. Each RPC method must
take a <code>&amp;self</code> reference and must return a <code>Result</code>. Next, we define a struct that implements this
trait.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Silly</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">SillyRpc</span> <span class="token keyword">for</span> <span class="token class-name">Silly</span> <span class="token punctuation">{</span>
	<span class="token keyword">fn</span> <span class="token function-definition function">silly_7</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">fn</span> <span class="token function-definition function">silly_double</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> val<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> val<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, to make the contents of this new file usable, we need to add a line in our <code>main.rs</code>.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">mod</span> <span class="token module-declaration namespace">silly_rpc</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="including-the-rpc"><a href="#including-the-rpc" class="header-anchor">#</a> Including the RPC</h2> <p>With our RPC written, we're ready to install it on our node. We begin with a few dependencies in our
<code>rpc-node</code>'s <code>Cargo.toml</code>.</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token key property">jsonrpc-core</span> <span class="token punctuation">=</span> <span class="token string">&quot;14.0.3&quot;</span>
<span class="token key property">jsonrpc-core-client</span> <span class="token punctuation">=</span> <span class="token string">&quot;14.0.3&quot;</span>
<span class="token key property">jsonrpc-derive</span> <span class="token punctuation">=</span> <span class="token string">&quot;14.0.3&quot;</span>
<span class="token key property">sc-rpc</span> <span class="token punctuation">=</span> <span class="token string">'2.0.0-rc4'</span>
</code></pre></div><p>Next, in our <code>rpc-node</code>'s <code>service.rs</code> file, we extend the service with our RPC. We've chosen to
install this RPC for full nodes, so we've included the code in the <code>new_full_start!</code> macro. You
could also install the RPC on a light client by making the corresponding changes to <code>new_light</code>.</p> <p>The first change to this macro is a simple type definition</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">type</span> <span class="token class-name">RpcExtension</span> <span class="token operator">=</span> <span class="token namespace">jsonrpc_core<span class="token punctuation">::</span></span><span class="token class-name">IoHandler</span><span class="token operator">&lt;</span><span class="token namespace">sc_rpc<span class="token punctuation">::</span></span><span class="token class-name">Metadata</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>Then, once you've called the service builder, you can extend it with an RPC by using its
<code>with_rpc_extensions</code> method as follows.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token punctuation">.</span><span class="token function">with_rpc_extensions</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>builder<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">RpcExtension</span><span class="token punctuation">,</span> _<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// Make an io handler to be extended with individual RPCs</span>
	<span class="token keyword">let</span> <span class="token keyword">mut</span> io <span class="token operator">=</span> <span class="token namespace">jsonrpc_core<span class="token punctuation">::</span></span><span class="token class-name">IoHandler</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Use the fully qualified name starting from `crate` because we're in macro_rules!</span>
	io<span class="token punctuation">.</span><span class="token function">extend_with</span><span class="token punctuation">(</span><span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>silly_rpc<span class="token punctuation">::</span></span><span class="token class-name">SillyRpc</span><span class="token punctuation">::</span><span class="token function">to_delegate</span><span class="token punctuation">(</span><span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>silly_rpc<span class="token punctuation">::</span></span><span class="token class-name">Silly</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// --snip--</span>

	<span class="token class-name">Ok</span><span class="token punctuation">(</span>io<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="calling-the-rpc"><a href="#calling-the-rpc" class="header-anchor">#</a> Calling the RPC</h2> <p>Once your node is running, you can test the RPC by calling it with any client that speaks json RPC.
One widely available option is <code>curl</code>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://localhost:9933 -H <span class="token string">&quot;Content-Type:application/json;charset=utf-8&quot;</span> -d   <span class="token string">'{
     &quot;jsonrpc&quot;:&quot;2.0&quot;,
      &quot;id&quot;:1,
      &quot;method&quot;:&quot;silly_seven&quot;,
      &quot;params&quot;: []
    }'</span>
</code></pre></div><p>To which the RPC responds</p> <div class="language- extra-class"><pre class="language-text"><code>{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;result&quot;:7,&quot;id&quot;:1}
</code></pre></div><p>You may have noticed that our second RPC takes a parameter, the value to double. You can supply this
parameter by including its in the <code>params</code> list. For example:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://localhost:9933 -H <span class="token string">&quot;Content-Type:application/json;charset=utf-8&quot;</span> -d   <span class="token string">'{
     &quot;jsonrpc&quot;:&quot;2.0&quot;,
      &quot;id&quot;:1,
      &quot;method&quot;:&quot;silly_double&quot;,
      &quot;params&quot;: [7]
    }'</span>
</code></pre></div><p>To which the RPC responds with the doubled parameter</p> <div class="language- extra-class"><pre class="language-text"><code>{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;result&quot;:14,&quot;id&quot;:1}
</code></pre></div><h2 id="rpc-to-call-a-runtime-api"><a href="#rpc-to-call-a-runtime-api" class="header-anchor">#</a> RPC to Call a Runtime API</h2> <p>The silly RPC demonstrates the fundamentals of working with RPCs in Substrate. Nonetheless, most
RPCs will go beyond what we've learned so far, and actually interact with other parts of the node.
In this second example, we will include an RPC that calls into the <code>sum-storage</code> runtime API from
the <a href="/3-entrees/runtime-api.html">runtime API recipe</a>. While it isn't strictly necessary to understand what the
runtime API does, reading that recipe may provide helpful context.</p> <p>Because this RPC's behavior is closely related to a specific pallet, we've chosen to define the RPC
in the pallet's directory. In this case the RPC is defined in <code>pallets/sum-storage/rpc</code>. So rather
than using the <code>mod</code> keyword as we did before, we must include this RPC definition in the node's
<code>Cargo.toml</code> file.</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token key property">sum-storage-rpc</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">path</span> <span class="token punctuation">=</span> <span class="token string">&quot;../../pallets/sum-storage/rpc&quot;</span> <span class="token punctuation">}</span>
</code></pre></div><p>Defining the RPC interface is similar to before, but there are a few differences worth noting.
First, the struct that implements the RPC needs a reference to the <code>client</code>. This is necessary so we
can actually call into the runtime. Second the struct is generic over the <code>BlockHash</code> type. This is
because it will call a runtime API, and runtime APIs must always be called at a specific block.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[rpc]</span>
<span class="token keyword">pub</span> <span class="token keyword">trait</span> <span class="token class-name">SumStorageApi</span><span class="token operator">&lt;</span><span class="token class-name">BlockHash</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	<span class="token attribute attr-name">#[rpc(name = <span class="token string">&quot;sumStorage_getSum&quot;</span>)]</span>
	<span class="token keyword">fn</span> <span class="token function-definition function">get_sum</span><span class="token punctuation">(</span>
		<span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span>
		at<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">BlockHash</span><span class="token operator">&gt;</span>
	<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/// A struct that implements the `SumStorageApi`.</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">SumStorage</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token class-name">M</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	client<span class="token punctuation">:</span> <span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
	_marker<span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>marker<span class="token punctuation">::</span></span><span class="token class-name">PhantomData</span><span class="token operator">&lt;</span><span class="token class-name">M</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token class-name">M</span><span class="token operator">&gt;</span> <span class="token class-name">SumStorage</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token class-name">M</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">/// Create new `SumStorage` instance with the given reference to the client.</span>
	<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>client<span class="token punctuation">:</span> <span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
		<span class="token keyword">Self</span> <span class="token punctuation">{</span> client<span class="token punctuation">,</span> _marker<span class="token punctuation">:</span> <span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The RPC's implementation is also similar to before. The additional syntax here is related to calling
the runtime at a specific block, as well as ensuring that the runtime we're calling actually has the
correct runtime API available.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token class-name">Block</span><span class="token operator">&gt;</span> <span class="token class-name">SumStorageApi</span><span class="token operator">&lt;&lt;</span><span class="token class-name">Block</span> <span class="token keyword">as</span> <span class="token class-name">BlockT</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token class-name">Hash</span><span class="token operator">&gt;</span>
	<span class="token keyword">for</span> <span class="token class-name">SumStorage</span><span class="token operator">&lt;</span><span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token class-name">Block</span><span class="token operator">&gt;</span>
<span class="token keyword">where</span>
	<span class="token class-name">Block</span><span class="token punctuation">:</span> <span class="token class-name">BlockT</span><span class="token punctuation">,</span>
	<span class="token class-name">C</span><span class="token punctuation">:</span> <span class="token class-name">Send</span> <span class="token operator">+</span> <span class="token class-name">Sync</span> <span class="token operator">+</span> <span class="token lifetime-annotation symbol">'static</span><span class="token punctuation">,</span>
	<span class="token class-name">C</span><span class="token punctuation">:</span> <span class="token class-name">ProvideRuntimeApi</span><span class="token punctuation">,</span>
	<span class="token class-name">C</span><span class="token punctuation">:</span> <span class="token class-name">HeaderBackend</span><span class="token operator">&lt;</span><span class="token class-name">Block</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
	<span class="token class-name">C</span><span class="token punctuation">::</span><span class="token class-name">Api</span><span class="token punctuation">:</span> <span class="token class-name">SumStorageRuntimeApi</span><span class="token operator">&lt;</span><span class="token class-name">Block</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
	<span class="token keyword">fn</span> <span class="token function-definition function">get_sum</span><span class="token punctuation">(</span>
		<span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span>
		at<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;&lt;</span><span class="token class-name">Block</span> <span class="token keyword">as</span> <span class="token class-name">BlockT</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token class-name">Hash</span><span class="token operator">&gt;</span>
	<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>

		<span class="token keyword">let</span> api <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">runtime_api</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">let</span> at <span class="token operator">=</span> <span class="token class-name">BlockId</span><span class="token punctuation">::</span><span class="token function">hash</span><span class="token punctuation">(</span>at<span class="token punctuation">.</span><span class="token function">unwrap_or_else</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span>
			<span class="token comment">// If the block hash is not supplied assume the best block.</span>
			<span class="token keyword">self</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>best_hash
		<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">let</span> runtime_api_result <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">get_sum</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>at<span class="token punctuation">)</span><span class="token punctuation">;</span>
		runtime_api_result<span class="token punctuation">.</span><span class="token function">map_err</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>e<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">RpcError</span> <span class="token punctuation">{</span>
			code<span class="token punctuation">:</span> <span class="token class-name">ErrorCode</span><span class="token punctuation">::</span><span class="token class-name">ServerError</span><span class="token punctuation">(</span><span class="token number">9876</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// No real reason for this value</span>
			message<span class="token punctuation">:</span> <span class="token string">&quot;Something wrong&quot;</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			data<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">&quot;{:?}&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, to install this RPC on in our service, we expand the existing <code>with_rpc_extensions</code> call to</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token punctuation">.</span><span class="token function">with_rpc_extensions</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>builder<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">RpcExtension</span><span class="token punctuation">,</span> _<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// Make an io handler to be extended with individual RPCs</span>
	<span class="token keyword">let</span> <span class="token keyword">mut</span> io <span class="token operator">=</span> <span class="token namespace">jsonrpc_core<span class="token punctuation">::</span></span><span class="token class-name">IoHandler</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Add the first rpc extension</span>
	io<span class="token punctuation">.</span><span class="token function">extend_with</span><span class="token punctuation">(</span><span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>silly_rpc<span class="token punctuation">::</span></span><span class="token class-name">SillyRpc</span><span class="token punctuation">::</span><span class="token function">to_delegate</span><span class="token punctuation">(</span><span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>silly_rpc<span class="token punctuation">::</span></span><span class="token class-name">Silly</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Add the second RPC extension</span>
	<span class="token comment">// Because this one calls a Runtime API it needs a reference to the client.</span>
	io<span class="token punctuation">.</span><span class="token function">extend_with</span><span class="token punctuation">(</span><span class="token namespace">sum_storage_rpc<span class="token punctuation">::</span></span><span class="token class-name">SumStorageApi</span><span class="token punctuation">::</span><span class="token function">to_delegate</span><span class="token punctuation">(</span><span class="token namespace">sum_storage_rpc<span class="token punctuation">::</span></span><span class="token class-name">SumStorage</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">Ok</span><span class="token punctuation">(</span>io<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="optional-rpc-parameters"><a href="#optional-rpc-parameters" class="header-anchor">#</a> Optional RPC Parameters</h2> <p>This RPC takes a parameter ,<code>at</code>, whose type is <code>Option&lt;_&gt;</code>. We may call this RPC by omitting the
optional parameter entirely. In this case the implementation provides a default value of the best
block.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://localhost:9933 -H <span class="token string">&quot;Content-Type:application/json;charset=utf-8&quot;</span> -d   <span class="token string">'{
     &quot;jsonrpc&quot;:&quot;2.0&quot;,
      &quot;id&quot;:1,
      &quot;method&quot;:&quot;sumStorage_getSum&quot;,
      &quot;params&quot;: []
    }'</span>
</code></pre></div><p>We may also call the RPC by providing a block hash. One easy way to get a block hash to test this
call is by copying it from the logs of a running node.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://localhost:9933 -H <span class="token string">&quot;Content-Type:application/json;charset=utf-8&quot;</span> -d   <span class="token string">'{
     &quot;jsonrpc&quot;:&quot;2.0&quot;,
      &quot;id&quot;:1,
      &quot;method&quot;:&quot;sumStorage_getSum&quot;,
      &quot;params&quot;: [&quot;0x87b2e4b93e74d2f06a0bde8de78c9e2a9823ce559eb5e3c4710de40a1c1071ac&quot;]
    }'</span>
</code></pre></div><p>As an exercise, change the storage values and confirm that the RPC provides the correct updated sum.
Then call the RPC at an old block and confirm you get the old sum.</p> <h2 id="polkadot-js-api"><a href="#polkadot-js-api" class="header-anchor">#</a> Polkadot JS API</h2> <p>Many frontends interact with Substrate nodes through Polkadot JS API. While the Recipes does not
strive to document that project, we have included a snippet of javascript for interacting with these
custom RPCs in the <code>nodes/rpc-node/js</code> directory.</p></div> <footer class="page-edit" style="display:none;"><div class="edit-link"><a href="https://github.com/tianxiemaochiyu/the_book_of_substrate_zh_CN/edit/master/docs/3-entrees/custom-rpc.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.a10ecbc3.js" defer></script><script src="/assets/js/3.911ff76f.js" defer></script><script src="/assets/js/1.8aeda072.js" defer></script><script src="/assets/js/32.ea727ff0.js" defer></script>
  </body>
</html>
