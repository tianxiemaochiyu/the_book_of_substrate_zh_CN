(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{409:function(t,e,n){t.exports=n.p+"assets/img/substrate-architecture.165c3188.png"},499:function(t,e,n){"use strict";n.r(e);var s=n(4),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"kitchen-organization"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kitchen-organization"}},[t._v("#")]),t._v(" Kitchen Organization")]),t._v(" "),s("p",[t._v("Now that your kitchen is well-equipped with all the right tools (bowls, knives, Rust compiler, etc),\nlet's take a look at how it is organized.")]),t._v(" "),s("h2",{attrs:{id:"structure-of-a-substrate-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#structure-of-a-substrate-node"}},[t._v("#")]),t._v(" Structure of a Substrate Node")]),t._v(" "),s("p",[t._v("It is useful to recognize that\n"),s("a",{attrs:{href:"https://youtu.be/05H4YsyPA-U?t=1789",target:"_blank",rel:"noopener noreferrer"}},[t._v("coding is all about abstraction"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("To understand how the code in this repository is organized, let's first take a look at how a\nSubstrate node is constructed. Each node has many components that manage things like the transaction\nqueue, communicating over a P2P network, reaching consensus on the state of the blockchain, and the\nchain's actual runtime logic. Each aspect of the node is interesting in its own right, and the\nruntime is particularly interesting because it contains the business logic (aka \"state transition\nfunction\") that codifies the chain's functionality.")]),t._v(" "),s("p",[t._v("Much, but not all, of the Recipes focuses on writing runtimes with FRAME, Parity's Framework for\ncomposing runtimes from individual building blocks called Pallets. Runtimes built with FRAME\ntypically contain several such pallets. The kitchen node you built previously follows this paradigm.")]),t._v(" "),s("p",[s("img",{attrs:{src:n(409),alt:"Substrate Architecture Diagram"}})]),t._v(" "),s("h2",{attrs:{id:"the-directories-in-our-kitchen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-directories-in-our-kitchen"}},[t._v("#")]),t._v(" The Directories in our Kitchen")]),t._v(" "),s("p",[t._v("There are five primary directories in this repository:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Text")]),t._v(": Source of "),s("a",{attrs:{href:"https://substrate.dev/recipes",target:"_blank",rel:"noopener noreferrer"}},[t._v("the book"),s("OutboundLink")],1),t._v(" written in markdown. This is what\nyou're reading right now.")]),t._v(" "),s("li",[s("strong",[t._v("Pallets")]),t._v(": Pallets for use in FRAME-based runtimes.")]),t._v(" "),s("li",[s("strong",[t._v("Runtimes")]),t._v(": Runtimes for use in Substrate nodes.")]),t._v(" "),s("li",[s("strong",[t._v("Consensus")]),t._v(": Consensus engines for use in Substrate nodes.")]),t._v(" "),s("li",[s("strong",[t._v("Nodes")]),t._v(": Complete Substrate nodes ready to run.")])]),t._v(" "),s("p",[t._v("Exploring those directories reveals a tree that looks like this")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("recipes\n|\n+-- text\n|\n+-- consensus\n  |\n  +-- shaw3pow\n|\n+-- nodes\n\t|\n\t+-- kitchen-node    <-- You built this previously\n\t|\n\t+-- rpc-node\n|\n+-- runtimes\n\t|\n\t+-- api-runtime\n\t|\n\t+-- super-runtime    <-- You built this too (it is part of the kitchen-node)\n\t|\n\t+-- weight-fee-runtime\n\t|\n\t+ ...\n|\n+-- pallets\n\t|\n\t+-- adding-machine    <-- You built this too (it is part of super-runtime)\n\t|\n\t+-- basic-token        <-- You built this too (it is part of super-runtime)\n\t|\n\t+ ...\n\t|\n\t+-- weights\n")])])]),s("h2",{attrs:{id:"inside-the-kitchen-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inside-the-kitchen-node"}},[t._v("#")]),t._v(" Inside the Kitchen Node")]),t._v(" "),s("p",[t._v("Let us take a deeper look at the\n"),s("a",{attrs:{href:"https://github.com/substrate-developer-hub/recipes/tree/master/nodes/kitchen-node",target:"_blank",rel:"noopener noreferrer"}},[t._v("Kitchen Node"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("Looking inside the Kitchen Node's "),s("code",[t._v("Cargo.toml")]),t._v(" file we see that it has many dependencies. Most of\nthem come from Substrate itself. Indeed most parts of this Kitchen Node are not unique or\nspecialized, and Substrate offers robust implementations that we can use. The runtime does not come\nfrom Substrate. Rather, we use our super-runtime which is in the "),s("code",[t._v("runtimes")]),t._v(" folder.")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("nodes/kitchen-node/Cargo.toml")])])]),t._v(" "),s("div",{staticClass:"language-TOML extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This node is compatible with any of the runtimes below")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Common runtime configured with most Recipes pallets.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("runtime")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"super-runtime"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../../runtimes/super-runtime"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Runtime with custom weight and fee calculation.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# runtime = { package = "weight-fee-runtime", path = "../../runtimes/weight-fee-runtime"}')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Runtime with off-chain worker enabled.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# To use this runtime, compile the node with `ocw` feature enabled,")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   `cargo build --release --features ocw`.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# runtime = { package = "ocw-runtime", path = "../../runtimes/ocw-runtime" }')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Runtime with custom runtime-api (custom API only used in rpc-node)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# runtime = { package = "api-runtime", path = "../../runtimes/api-runtime" }')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ---")]),t._v("\n")])])]),s("p",[t._v("The commented lines, quoted above, show that the Super Runtime is not the only runtime we could have\nchosen. We could also use the Weight-Fee runtime, and I encourage you to try that experiment\n(remember, instructions to re-compile the node are in the previous section).")]),t._v(" "),s("p",[t._v("Every node must have a runtime. You may confirm that by looking at the "),s("code",[t._v("Cago.toml")]),t._v(" files of the\nother nodes included in our kitchen.")]),t._v(" "),s("h2",{attrs:{id:"inside-the-super-runtime"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inside-the-super-runtime"}},[t._v("#")]),t._v(" Inside the Super Runtime")]),t._v(" "),s("p",[t._v("Having seen that the Kitchen Node depends on a runtime, let us now look deeper at the\n"),s("a",{attrs:{href:"https://github.com/substrate-developer-hub/recipes/tree/master/runtimes/super-runtime",target:"_blank",rel:"noopener noreferrer"}},[t._v("Super Runtime"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[s("strong",[s("code",[t._v("runtimes/super-runtime/Cargo.toml")])])]),t._v(" "),s("div",{staticClass:"language-TOML extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -- snip --")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Substrate Pallets")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("balances")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pallet-balances'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("transaction-payment")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pallet-transaction-payment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Recipe Pallets")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("adding-machine")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../../pallets/adding-machine"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("default-features")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("basic-token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../../pallets/basic-token"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("default-features")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Here we see that the runtime depends on many pallets. Some of these pallets come from Substrate\nitself. Indeed, Substrate offers a rich collection of commonly used pallets which you may use in\nyour own runtimes. This runtime also contains several custom pallets that are written right here in\nour Kitchen.")]),t._v(" "),s("h2",{attrs:{id:"common-patterns"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#common-patterns"}},[t._v("#")]),t._v(" Common Patterns")]),t._v(" "),s("p",[t._v("We will not yet look closely at individual Pallets. We will begin that endeavor in the next chapter\n-- Appetizers.")]),t._v(" "),s("p",[t._v("We've just observed the general pattern used throughout the recipes. From the inside out, we see a\npiece of pallet code stored in "),s("code",[t._v("pallets/<pallet-name>/src/lib.rs")]),t._v(". The pallet is then included into\na runtime by adding its name and relative path in "),s("code",[t._v("runtimes/<runtime-name>/Cargo.toml")]),t._v(". That runtime\nis then installed in a node by adding its name and relative path in "),s("code",[t._v("nodes/<node-name>/Cargo.toml")]),t._v(".\nOf course adding pallets and runtimes also requires changing actual "),s("em",[t._v("code")]),t._v(" as well. We will cover\nthose details in due course. For now we're just focusing on macroscopic relationships between the\nparts of a Substrate node.")]),t._v(" "),s("p",[t._v("Some recipes explore aspects of Blockchain development that are outside of the runtime. Looking back\nto our node architecture at the beginning of this section, you can imagine that changing a node's\nRPC or Consensus would be conceptually similar to changing its runtime.")]),t._v(" "),s("h2",{attrs:{id:"additional-resources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#additional-resources"}},[t._v("#")]),t._v(" Additional Resources")]),t._v(" "),s("p",[t._v("Substrate Developer Hub offers tutorials that go into more depth about writing pallets and including\nthem in runtimes. If you desire, you may read them as well.")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://substrate.dev/docs/en/tutorials/create-a-pallet/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Creating an External Pallet"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://substrate.dev/docs/en/tutorials/add-a-pallet-to-your-runtime/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Adding a Pallet to Your Runtime Tutorial"),s("OutboundLink")],1)])]),t._v(" "),s("h1",{attrs:{id:"let-s-get-cooking"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#let-s-get-cooking"}},[t._v("#")]),t._v(" Let's Get Cooking!")]),t._v(" "),s("p",[t._v("When you're ready, we can begin by cooking some appetizer pallets.")])])}),[],!1,null,null,null);e.default=a.exports}}]);